function cov_mk4ietst1(){var path="C:\\Users\\IIITB\\Downloads\\iot-fuzz-examples\\Sync-Async\\handler.js";var hash="58c73b131f6f1ff134b79fda528475d63cd1e347";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\IIITB\\Downloads\\iot-fuzz-examples\\Sync-Async\\handler.js",statementMap:{"0":{start:{line:1,column:13},end:{line:1,column:28}},"1":{start:{line:3,column:18},end:{line:3,column:41}},"2":{start:{line:4,column:15},end:{line:4,column:38}},"3":{start:{line:6,column:0},end:{line:15,column:3}},"4":{start:{line:7,column:2},end:{line:7,column:37}},"5":{start:{line:8,column:2},end:{line:14,column:5}},"6":{start:{line:9,column:4},end:{line:13,column:5}},"7":{start:{line:10,column:6},end:{line:10,column:45}},"8":{start:{line:12,column:6},end:{line:12,column:58}},"9":{start:{line:17,column:0},end:{line:44,column:3}},"10":{start:{line:19,column:2},end:{line:43,column:5}},"11":{start:{line:21,column:4},end:{line:26,column:5}},"12":{start:{line:22,column:6},end:{line:22,column:47}},"13":{start:{line:24,column:6},end:{line:24,column:50}},"14":{start:{line:25,column:6},end:{line:25,column:13}},"15":{start:{line:28,column:21},end:{line:28,column:64}},"16":{start:{line:29,column:18},end:{line:29,column:31}},"17":{start:{line:31,column:4},end:{line:31,column:58}},"18":{start:{line:34,column:4},end:{line:34,column:60}},"19":{start:{line:34,column:33},end:{line:34,column:58}},"20":{start:{line:35,column:4},end:{line:35,column:50}},"21":{start:{line:37,column:4},end:{line:40,column:5}},"22":{start:{line:38,column:6},end:{line:38,column:69}},"23":{start:{line:42,column:4},end:{line:42,column:52}},"24":{start:{line:47,column:0},end:{line:49,column:3}},"25":{start:{line:48,column:2},end:{line:48,column:43}},"26":{start:{line:54,column:0},end:{line:69,column:3}},"27":{start:{line:55,column:21},end:{line:55,column:25}},"28":{start:{line:57,column:4},end:{line:60,column:14}},"29":{start:{line:58,column:23},end:{line:58,column:53}},"30":{start:{line:59,column:8},end:{line:59,column:62}},"31":{start:{line:59,column:31},end:{line:59,column:62}},"32":{start:{line:62,column:4},end:{line:68,column:5}},"33":{start:{line:63,column:24},end:{line:66,column:10}},"34":{start:{line:67,column:8},end:{line:67,column:52}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:21},end:{line:6,column:22}},loc:{start:{line:6,column:27},end:{line:15,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:39},end:{line:8,column:40}},loc:{start:{line:8,column:48},end:{line:14,column:3}},line:8},"2":{name:"(anonymous_2)",decl:{start:{line:17,column:21},end:{line:17,column:22}},loc:{start:{line:17,column:41},end:{line:44,column:1}},line:17},"3":{name:"(anonymous_3)",decl:{start:{line:19,column:3},end:{line:19,column:4}},loc:{start:{line:19,column:15},end:{line:41,column:3}},line:19},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:22},end:{line:34,column:23}},loc:{start:{line:34,column:33},end:{line:34,column:58}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:41,column:13},end:{line:41,column:14}},loc:{start:{line:41,column:20},end:{line:43,column:3}},line:41},"6":{name:"(anonymous_6)",decl:{start:{line:47,column:19},end:{line:47,column:20}},loc:{start:{line:47,column:26},end:{line:49,column:1}},line:47},"7":{name:"(anonymous_7)",decl:{start:{line:54,column:21},end:{line:54,column:22}},loc:{start:{line:54,column:41},end:{line:69,column:1}},line:54}},branchMap:{"0":{loc:{start:{line:9,column:4},end:{line:13,column:5}},type:"if",locations:[{start:{line:9,column:4},end:{line:13,column:5}},{start:{line:11,column:11},end:{line:13,column:5}}],line:9},"1":{loc:{start:{line:28,column:21},end:{line:28,column:64}},type:"binary-expr",locations:[{start:{line:28,column:21},end:{line:28,column:37}},{start:{line:28,column:41},end:{line:28,column:51}},{start:{line:28,column:55},end:{line:28,column:64}}],line:28},"2":{loc:{start:{line:37,column:4},end:{line:40,column:5}},type:"if",locations:[{start:{line:37,column:4},end:{line:40,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:37},"3":{loc:{start:{line:37,column:8},end:{line:37,column:42}},type:"binary-expr",locations:[{start:{line:37,column:8},end:{line:37,column:27}},{start:{line:37,column:31},end:{line:37,column:42}}],line:37},"4":{loc:{start:{line:59,column:8},end:{line:59,column:62}},type:"if",locations:[{start:{line:59,column:8},end:{line:59,column:62}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:59},"5":{loc:{start:{line:62,column:4},end:{line:68,column:5}},type:"if",locations:[{start:{line:62,column:4},end:{line:68,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:62},"6":{loc:{start:{line:62,column:8},end:{line:62,column:50}},type:"binary-expr",locations:[{start:{line:62,column:8},end:{line:62,column:27}},{start:{line:62,column:31},end:{line:62,column:50}}],line:62}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"58c73b131f6f1ff134b79fda528475d63cd1e347"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_mk4ietst1=function(){return actualCoverage;};}return actualCoverage;}cov_mk4ietst1();const mqtt=(cov_mk4ietst1().s[0]++,require('mqtt'));const brokerUrl=(cov_mk4ietst1().s[1]++,'mqtt://localhost:1883');const client=(cov_mk4ietst1().s[2]++,mqtt.connect(brokerUrl));cov_mk4ietst1().s[3]++;client.on('connect',()=>{cov_mk4ietst1().f[0]++;cov_mk4ietst1().s[4]++;console.log('Connected to broker');cov_mk4ietst1().s[5]++;client.subscribe('device/test/data',err=>{cov_mk4ietst1().f[1]++;cov_mk4ietst1().s[6]++;if(err){cov_mk4ietst1().b[0][0]++;cov_mk4ietst1().s[7]++;console.error('Subscribe error:',err);}else{cov_mk4ietst1().b[0][1]++;cov_mk4ietst1().s[8]++;console.log('Subscribed to topic device/test/data');}});});cov_mk4ietst1().s[9]++;client.on('message',(topic,message)=>{cov_mk4ietst1().f[2]++;cov_mk4ietst1().s[10]++;// wrap in async IIFE so you can use await
(async()=>{cov_mk4ietst1().f[3]++;let payload;cov_mk4ietst1().s[11]++;try{cov_mk4ietst1().s[12]++;payload=JSON.parse(message.toString());}catch(err){cov_mk4ietst1().s[13]++;console.error("Invalid JSON payload:",err);cov_mk4ietst1().s[14]++;return;}const deviceId=(cov_mk4ietst1().s[15]++,(cov_mk4ietst1().b[1][0]++,payload.deviceId)||(cov_mk4ietst1().b[1][1]++,payload.id)||(cov_mk4ietst1().b[1][2]++,'unknown'));const value=(cov_mk4ietst1().s[16]++,payload.value);cov_mk4ietst1().s[17]++;console.log(`Device ${deviceId} sent value ${value}`);// asynchronous work, e.g. DB call, delay, external I/O
cov_mk4ietst1().s[18]++;await new Promise(resolve=>{cov_mk4ietst1().f[4]++;cov_mk4ietst1().s[19]++;return setTimeout(resolve,1000);});cov_mk4ietst1().s[20]++;console.log("Async work done after 1s delay");cov_mk4ietst1().s[21]++;if((cov_mk4ietst1().b[3][0]++,value!==undefined)&&(cov_mk4ietst1().b[3][1]++,value>100)){cov_mk4ietst1().b[2][0]++;cov_mk4ietst1().s[22]++;console.log(`⚠️ Value too high (${value}) — alert logic here`);// e.g. alert, persist to DB, publish another MQTT, etc.
}else{cov_mk4ietst1().b[2][1]++;}})().catch(err=>{cov_mk4ietst1().f[5]++;cov_mk4ietst1().s[23]++;console.error("Error processing message:",err);});});// optionally handle errors
cov_mk4ietst1().s[24]++;client.on('error',err=>{cov_mk4ietst1().f[6]++;cov_mk4ietst1().s[25]++;console.error("MQTT client error:",err);});cov_mk4ietst1().s[26]++;client.on('message',(topic,message)=>{cov_mk4ietst1().f[7]++;let testCaseId=(cov_mk4ietst1().s[27]++,null);cov_mk4ietst1().s[28]++;try{const parsed=(cov_mk4ietst1().s[29]++,JSON.parse(message.toString()));cov_mk4ietst1().s[30]++;if(parsed.testCaseId){cov_mk4ietst1().b[4][0]++;cov_mk4ietst1().s[31]++;testCaseId=parsed.testCaseId;}else{cov_mk4ietst1().b[4][1]++;}}catch{}cov_mk4ietst1().s[32]++;if((cov_mk4ietst1().b[6][0]++,global.__coverage__)&&(cov_mk4ietst1().b[6][1]++,testCaseId!==null)){cov_mk4ietst1().b[5][0]++;const payload=(cov_mk4ietst1().s[33]++,JSON.stringify({testCaseId,coverage:global.__coverage__}));cov_mk4ietst1().s[34]++;client.publish('coverage/handler',payload);}else{cov_mk4ietst1().b[5][1]++;}});